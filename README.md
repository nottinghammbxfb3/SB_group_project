# Franklin Brown Github repository
Generating structural and functional predictions for candidate genes generated by a selection scan.

## Introduction
The aims of this workflow:
- To create a consensus sequence of most common alleles at each nucleotide from tetraploid and diploid samples for candidate genes.
- Generate mutated protein sequences.
- Identify position and substitution of mutations.
- Generate structure prediction models for mutated and reference proteins.
- Make functional predictions of mutations in different samples.

## Installation

To visualize and verify consensus sequence:
- IGV (version 2.17.2; Robinson et al., 2011)
  - https://igv.org/
 
To create consensus sequence:
- Pandas (version 2.1.1; McKinney, W. & others, 2010, pp.51--56)
  - pip install pandas
  - https://pandas.pydata.org/
- Python (version 3.11.6)
  - https://www.python.org/
- Argparse (version 1.1)
  - pip install argparse
  - https://docs.python.org/3/library/argparse.html

## Data
- Reference genome:
  - C_excelsa_V5.fasta
- Reference annotation:
  - C_excelsa_V5_braker2_wRseq.gff3
- Variant call files:
  - UK_scan_dips.vcf (diploids)
  - UK_scan_tets.vcf (tetraploids)
- Gene names:
  - g30996 (chromosome 3)
  - g50328 (chromosome 6)
 
## Code
To create consensus proteins:
- Using VCF_consensus.py:
  - chromosome_number  Chromosome number
  - gene_name          Gene name (Same format as in GFF file)
  - gff_path           Path to GFF file
  - vcf_path           Path to VCF file
  - reference_path     Path to reference FASTA file
  - snp_finder_output  Output file for SNP finder (.csv)
  - consensus_output   Output file for consensus sequence (.txt)
  - dna_to_aa_output   Output file for DNA to AA translation (.txt)
- Example usage:
  - python VCF_consensus.py 6 g50328 gff_file.gff3 vcf_file.vcf reference_genome.fasta snps_out.csv consensus_out.txt translation_out.txt
 
Function explanation: (For detail on code used please view VCF_consensus.py)
- SNP finder:
  - Reads VCF file into pandas dataframe
  - Selects specified chromosome rows
  - Reads GFF file in to pandas dataframe
  - Selects specified chromsome, gene name and coding regions
  - Selects VCF rows corresponding to coding regions identified in GFF file
  - Create seperate VCF subsets of multiallelic and biallelic sites
  - Create alternative allele frequency column for both subsets
  - For biallelic subset, select rows above 0.5 frequency (most frequent)
  - For multiallelic subset, create reference allele frequency column:
    - Identify most frequent alternative allele
    - Remove rows where reference is more frequent than most frequent alternative allele
    - Checking throughout there are any alternative alleles remaining to avoid downstream error
  - Merge biallelic and multiallelic subsets and output as .csv for consensus
  - 







